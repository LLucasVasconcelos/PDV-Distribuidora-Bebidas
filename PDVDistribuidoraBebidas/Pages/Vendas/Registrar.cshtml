@page
@model RegistrarModel

<h2>Ponto de Venda (PDV)</h2>

<div class="card p-3 mb-4">
    <form method="post" asp-page-handler="Adicionar">
        <div class="row">
            <div class="col-md-6">
                <select name="produtoId" class="form-control" required>
                    @foreach (var p in Model.ProdutosDisponiveis)
                    {
                        <option value="@p.Id">@p.Nome (@p.Preco.ToString("C"))</option>
                    }
                </select>
            </div>
            <div class="col-md-3">
                <input type="number" name="quantidade" value="1" min="1" class="form-control" />
            </div>
            <div class="col-md-3">
                <button type="submit" class="btn btn-info w-100">Adicionar Item</button>
            </div>
        </div>
    </form>
</div>

<h4>Itens da Venda Atual</h4>
<table class="table">
    <thead>
        <tr>
            <th>Produto</th>
            <th>Qtd</th>
            <th>Preço Un.</th>
            <th>Subtotal</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in RegistrarModel.Carrinho)
        {
            <tr>
                <td>@item.Nome</td>
                <td>@item.Quantidade</td>
                <td>@item.PrecoUnitario.ToString("C")</td>
                <td>@item.Subtotal.ToString("C")</td>
            </tr>
        }
    </tbody>
    <tfoot>
        <tr>
            <th colspan="3" class="text-end">VALOR FINAL:</th>
            <th class="table-primary">@Model.TotalVenda.ToString("C")</th>
        </tr>
    </tfoot>
</table>

@if (RegistrarModel.Carrinho.Any())
{
    <form method="post" asp-page-handler="Finalizar">
        <button type="submit" class="btn btn-success btn-lg w-100">Confirmar e Finalizar Compra</button>
    </form>
}